<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FDA 21 CFR Part 11 Compliance Demonstration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Mobile responsive styles for FDA Compliance */
        @media (max-width: 768px) {
            .container { padding: 0 0.5rem; }
            h1 { font-size: 1.25rem !important; }
            h2 { font-size: 1rem !important; }
            .text-xl { font-size: 1rem !important; }
            .text-sm { font-size: 0.75rem !important; }
            
            /* Stack grids on mobile */
            .grid { 
                grid-template-columns: 1fr !important; 
                gap: 0.5rem !important;
            }
            
            /* Make audit trail scrollable */
            #auditTrail { 
                font-size: 0.625rem !important;
                max-height: 200px;
                overflow-y: auto;
            }
            
            /* Stack signature form */
            .md\\:grid-cols-2 { 
                grid-template-columns: 1fr !important; 
            }
            
            /* Full width buttons on mobile */
            button { 
                width: 100%; 
                padding: 0.75rem;
                font-size: 0.875rem;
            }
            
            /* Adjust padding */
            .p-6 { padding: 1rem !important; }
            .p-4 { padding: 0.75rem !important; }
            .p-3 { padding: 0.5rem !important; }
            
            /* ALCOA+ principles responsive */
            .grid-cols-5 { 
                grid-template-columns: repeat(3, 1fr) !important; 
            }
            
            /* Make compliance checklist items smaller */
            .bg-gray-700 .font-bold { 
                font-size: 0.75rem !important; 
            }
            
            /* Hide icons on very small screens */
            @media (max-width: 480px) {
                .fa-3xl { font-size: 1.5rem !important; }
                .text-2xl { font-size: 1.25rem !important; }
            }
        }
        
        /* Ensure readable text on all devices */
        body { 
            -webkit-text-size-adjust: 100%;
            text-size-adjust: 100%;
        }
        
        /* Better touch targets for mobile */
        input, button { 
            min-height: 44px; 
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <!-- Header -->
    <header class="bg-blue-900 shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center space-x-4">
                <i class="fas fa-shield-alt text-3xl text-green-400"></i>
                <div>
                    <h1 class="text-2xl font-bold">FDA 21 CFR Part 11 Compliance Portal</h1>
                    <p class="text-sm opacity-90">Electronic Records & Electronic Signatures Validation System</p>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-6">
        <!-- Compliance Status Overview -->
        <div class="bg-gray-800 rounded-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4 text-green-400">
                <i class="fas fa-check-circle mr-2"></i>
                SYSTEM IS FULLY COMPLIANT
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="bg-green-900 rounded-lg p-4">
                    <i class="fas fa-file-signature text-3xl mb-2"></i>
                    <p class="font-bold">Electronic Signatures</p>
                    <p class="text-sm">Biometric + Password</p>
                </div>
                <div class="bg-green-900 rounded-lg p-4">
                    <i class="fas fa-history text-3xl mb-2"></i>
                    <p class="font-bold">Audit Trail</p>
                    <p class="text-sm">Immutable & Timestamped</p>
                </div>
                <div class="bg-green-900 rounded-lg p-4">
                    <i class="fas fa-user-shield text-3xl mb-2"></i>
                    <p class="font-bold">Access Control</p>
                    <p class="text-sm">Role-Based (RBAC)</p>
                </div>
                <div class="bg-green-900 rounded-lg p-4">
                    <i class="fas fa-lock text-3xl mb-2"></i>
                    <p class="font-bold">Data Integrity</p>
                    <p class="text-sm">Cryptographic Hash</p>
                </div>
            </div>
        </div>

        <!-- Live Audit Trail -->
        <div class="bg-gray-800 rounded-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">
                <i class="fas fa-history mr-2"></i>
                Real-Time Audit Trail (21 CFR 11.10(e))
            </h2>
            <div class="bg-black rounded-lg p-4 font-mono text-sm" id="auditTrail">
                <!-- Audit entries will be added here -->
            </div>
            <button onclick="addAuditEntry()" class="mt-4 bg-blue-600 px-4 py-2 rounded hover:bg-blue-700">
                <i class="fas fa-plus mr-2"></i>Simulate Batch Action
            </button>
        </div>

        <!-- Electronic Signature Demo -->
        <div class="bg-gray-800 rounded-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">
                <i class="fas fa-signature mr-2"></i>
                Electronic Signature Verification (21 CFR 11.50)
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-bold mb-2">Sign Batch Release</h3>
                    <input type="text" placeholder="Username" class="w-full p-2 mb-2 bg-gray-700 rounded" id="username">
                    <input type="password" placeholder="Password" class="w-full p-2 mb-2 bg-gray-700 rounded" id="password">
                    <input type="text" placeholder="Reason for Signing" class="w-full p-2 mb-2 bg-gray-700 rounded" id="reason">
                    <button onclick="performESignature()" class="w-full bg-green-600 px-4 py-2 rounded hover:bg-green-700">
                        <i class="fas fa-pen mr-2"></i>Apply E-Signature
                    </button>
                </div>
                <div>
                    <h3 class="font-bold mb-2">Signature Manifest</h3>
                    <div class="bg-gray-700 rounded p-3 text-sm" id="signatureManifest">
                        <p class="text-gray-400">No signatures yet...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Compliance Requirements Checklist -->
        <div class="bg-gray-800 rounded-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">
                <i class="fas fa-clipboard-check mr-2"></i>
                21 CFR Part 11 Requirements Checklist
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="space-y-2">
                    <div class="flex items-center p-2 bg-gray-700 rounded">
                        <i class="fas fa-check text-green-400 mr-3"></i>
                        <div>
                            <p class="font-bold">11.10(a) - Validation</p>
                            <p class="text-sm text-gray-400">System validated for intended use</p>
                        </div>
                    </div>
                    <div class="flex items-center p-2 bg-gray-700 rounded">
                        <i class="fas fa-check text-green-400 mr-3"></i>
                        <div>
                            <p class="font-bold">11.10(b) - Copy Protection</p>
                            <p class="text-sm text-gray-400">Accurate & complete copies</p>
                        </div>
                    </div>
                    <div class="flex items-center p-2 bg-gray-700 rounded">
                        <i class="fas fa-check text-green-400 mr-3"></i>
                        <div>
                            <p class="font-bold">11.10(c) - Record Retention</p>
                            <p class="text-sm text-gray-400">Records retained per FDA requirements</p>
                        </div>
                    </div>
                    <div class="flex items-center p-2 bg-gray-700 rounded">
                        <i class="fas fa-check text-green-400 mr-3"></i>
                        <div>
                            <p class="font-bold">11.10(d) - System Access</p>
                            <p class="text-sm text-gray-400">Limited to authorized individuals</p>
                        </div>
                    </div>
                </div>
                <div class="space-y-2">
                    <div class="flex items-center p-2 bg-gray-700 rounded">
                        <i class="fas fa-check text-green-400 mr-3"></i>
                        <div>
                            <p class="font-bold">11.10(e) - Audit Trails</p>
                            <p class="text-sm text-gray-400">Secure, time-stamped audit trails</p>
                        </div>
                    </div>
                    <div class="flex items-center p-2 bg-gray-700 rounded">
                        <i class="fas fa-check text-green-400 mr-3"></i>
                        <div>
                            <p class="font-bold">11.10(g) - Authority Checks</p>
                            <p class="text-sm text-gray-400">User authority verification</p>
                        </div>
                    </div>
                    <div class="flex items-center p-2 bg-gray-700 rounded">
                        <i class="fas fa-check text-green-400 mr-3"></i>
                        <div>
                            <p class="font-bold">11.10(k) - Documentation</p>
                            <p class="text-sm text-gray-400">System documentation controls</p>
                        </div>
                    </div>
                    <div class="flex items-center p-2 bg-gray-700 rounded">
                        <i class="fas fa-check text-green-400 mr-3"></i>
                        <div>
                            <p class="font-bold">11.50 - Signature Manifestations</p>
                            <p class="text-sm text-gray-400">Name, date, time, meaning</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Integrity Verification -->
        <div class="bg-gray-800 rounded-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">
                <i class="fas fa-fingerprint mr-2"></i>
                Data Integrity Verification (ALCOA+ Principles)
            </h2>
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 text-center">
                <div class="bg-gray-700 rounded p-3">
                    <p class="text-2xl font-bold text-green-400">A</p>
                    <p class="text-sm">Attributable</p>
                    <i class="fas fa-check-circle text-green-400 mt-2"></i>
                </div>
                <div class="bg-gray-700 rounded p-3">
                    <p class="text-2xl font-bold text-green-400">L</p>
                    <p class="text-sm">Legible</p>
                    <i class="fas fa-check-circle text-green-400 mt-2"></i>
                </div>
                <div class="bg-gray-700 rounded p-3">
                    <p class="text-2xl font-bold text-green-400">C</p>
                    <p class="text-sm">Contemporaneous</p>
                    <i class="fas fa-check-circle text-green-400 mt-2"></i>
                </div>
                <div class="bg-gray-700 rounded p-3">
                    <p class="text-2xl font-bold text-green-400">O</p>
                    <p class="text-sm">Original</p>
                    <i class="fas fa-check-circle text-green-400 mt-2"></i>
                </div>
                <div class="bg-gray-700 rounded p-3">
                    <p class="text-2xl font-bold text-green-400">A</p>
                    <p class="text-sm">Accurate</p>
                    <i class="fas fa-check-circle text-green-400 mt-2"></i>
                </div>
            </div>
            <div class="mt-4 p-4 bg-blue-900 rounded">
                <p class="text-sm">
                    <i class="fas fa-info-circle mr-2"></i>
                    <strong>Data Integrity Hash:</strong> SHA-256: 7d865e959b2466918c9863afca942d0fb89d7c9ac0c99bafc3749504ded97730
                </p>
            </div>
        </div>

        <!-- Generate Compliance Report -->
        <div class="bg-gray-800 rounded-lg p-6">
            <h2 class="text-xl font-bold mb-4">
                <i class="fas fa-file-pdf mr-2"></i>
                Generate FDA Compliance Report
            </h2>
            <button onclick="generateComplianceReport()" class="bg-green-600 px-6 py-3 rounded hover:bg-green-700">
                <i class="fas fa-download mr-2"></i>
                Generate 21 CFR Part 11 Compliance Report
            </button>
            <div id="reportStatus" class="mt-4"></div>
        </div>
    </div>

    <!-- Back to Dashboard -->
    <div class="container mx-auto px-4 py-6">
        <a href="pharma-dashboard.html" class="text-blue-400 hover:text-blue-300">
            <i class="fas fa-arrow-left mr-2"></i>Back to Pharma Dashboard
        </a>
    </div>

    <script>
        // Simulate audit trail entries
        let auditEntries = [];
        
        function addAuditEntry() {
            const actions = [
                'Batch #2024-0847 temperature adjusted to 21.3°C',
                'QC sample collected from Line A',
                'Batch #2024-0848 approved for release',
                'Clean room pressure validated at +25 Pa',
                'User JSmith logged in with biometric authentication',
                'Deviation DEV-2024-0012 created and under review',
                'Batch record electronically signed by QA Manager',
                'Environmental monitoring data recorded'
            ];
            
            const entry = {
                timestamp: new Date().toISOString(),
                user: 'SYSTEM/JSmith',
                action: actions[Math.floor(Math.random() * actions.length)],
                hash: generateHash()
            };
            
            auditEntries.unshift(entry);
            updateAuditDisplay();
        }
        
        function updateAuditDisplay() {
            const container = document.getElementById('auditTrail');
            container.innerHTML = auditEntries.slice(0, 10).map(entry => `
                <div class="mb-2 text-green-400">
                    [${entry.timestamp}] USER: ${entry.user}
                    <br>ACTION: ${entry.action}
                    <br>HASH: ${entry.hash}
                    <br>STATUS: IMMUTABLE - CANNOT BE MODIFIED OR DELETED
                </div>
            `).join('');
        }
        
        function generateHash() {
            return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
        }
        
        function performESignature() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const reason = document.getElementById('reason').value;
            
            if (!username || !password || !reason) {
                alert('All fields required for electronic signature');
                return;
            }
            
            const signature = {
                signer: username,
                timestamp: new Date().toISOString(),
                reason: reason,
                meaning: 'I hereby approve this action',
                hash: generateHash()
            };
            
            document.getElementById('signatureManifest').innerHTML = `
                <p class="font-bold text-green-400">✓ Signature Applied</p>
                <p class="text-sm mt-2">
                    <strong>Signer:</strong> ${signature.signer}<br>
                    <strong>Date/Time:</strong> ${signature.timestamp}<br>
                    <strong>Reason:</strong> ${signature.reason}<br>
                    <strong>Meaning:</strong> ${signature.meaning}<br>
                    <strong>Hash:</strong> ${signature.hash}<br>
                    <strong>Status:</strong> <span class="text-green-400">VALID & BINDING</span>
                </p>
            `;
            
            // Add to audit trail
            auditEntries.unshift({
                timestamp: signature.timestamp,
                user: signature.signer,
                action: `Electronic signature applied: ${reason}`,
                hash: signature.hash
            });
            updateAuditDisplay();
            
            // Clear form
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('reason').value = '';
        }
        
        function generateComplianceReport() {
            document.getElementById('reportStatus').innerHTML = `
                <div class="bg-green-900 rounded p-4">
                    <p class="font-bold text-green-400">
                        <i class="fas fa-check-circle mr-2"></i>
                        Compliance Report Generated Successfully
                    </p>
                    <p class="text-sm mt-2">
                        Report ID: FDA-RPT-2024-${Math.floor(Math.random() * 10000)}<br>
                        Generated: ${new Date().toISOString()}<br>
                        Status: COMPLIANT - All 21 CFR Part 11 requirements met<br>
                        Audit Records: ${auditEntries.length} entries<br>
                        Next FDA Audit: Q2 2025
                    </p>
                </div>
            `;
        }
        
        // Initialize with some audit entries
        for (let i = 0; i < 5; i++) {
            addAuditEntry();
        }
    </script>
</body>
</html>